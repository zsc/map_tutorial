# 第 8 章：SAR 影像与多光谱影像进阶

**——穿透云雾的“微波之眼”与多源数据融合**

## 1. 开篇段落

在之前的章节中，我们掌握了基于“光学”（可见光与近红外）的卫星影像。光学影像符合人类的视觉直觉，色彩丰富，易于解译。然而，在实际的全球地图构建和灾害监测中，光学影像面临着一个不可逾越的物理障碍：**云雾**。地球表面平均约有 60% 至 70% 的区域常年被云层覆盖，这使得在洪涝、台风或热带地区获取连续的地面数据变得极具挑战。

本章将引入**合成孔径雷达（SAR, Synthetic Aperture Radar）**技术。作为一种主动式微波遥感，SAR 具备“全天时（Day/Night）、全天候（All-weather）”的成像能力。它不依赖太阳光，而是自带“探照灯”（发射微波），并能穿透云雨烟雾。同时，我们将探讨多光谱影像中除 RGB 之外的“隐形波段”（如短波红外、红边），并展示如何将 SAR 的**结构信息**与多光谱的**生化信息**融合（Fusion），以构建更具鲁棒性的全球动态地图。

**本章学习目标：**
1. 深入理解 SAR 的成像物理机制：波长、极化、散射机理与雷达方程。
2. 彻底掌握 SAR 独特的侧视几何畸变（透视收缩、叠掩、阴影）及其物理成因。
3. 熟悉 SAR 数据的标准处理流水线：从 SLC/GRD 到地形校正（RTC）与分贝化（dB）。
4. 掌握多光谱的高级波段应用（SWIR, Red Edge）及指数计算。
5. 学会“SAR + 多光谱”的数据融合逻辑，解决单一数据源的痛点。

---

## 2. 核心概念与论述

### 2.1 为什么我们需要微波？（光学 vs. SAR）

在构建多尺度地图时，理解传感器的质差异至关重要。

| 特性 | 光学 (Optical) | 合成孔径雷达 (SAR) |
| :--- | :--- | :--- |
| **工作方式** | **被动 (Passive)**：接收太阳反射光 | **主动 (Active)**：自发脉冲，接收回波 |
| **能量来源** | 太阳 | 卫星自带电源 |
| **波长范围** | 0.4 - 2.5 $\mu m$ (微米级) | 1cm - 1m (厘米/分米级) |
| **成像依赖** | 依赖光照，受云雾、烟尘遮挡 | 不依赖光照，穿透云雨、甚至部分植被 |
| **测量内容** | **化学特性**：叶绿素、色素、含水量 | **物理结构**：粗糙度、几何形状、介电常数 |
| **视觉直观性** | 高 (所见即所得) | 低 (类似超声波/X光片，需专业判读) |

### 2.2 SAR 成像物理基础

SAR 图像的每一个像素值，代表了该位置对雷达波的**后向散射系数 (Backscatter Coefficient, $\sigma^0$)**。

#### 2.2.1 雷达方程与亮度决定因素
简化的雷达方程表明接收功率 $P_r$ 与目标距离 $R$ 的四次方成反比：
$$ P_r = \frac{P_t G^2 \lambda^2 \sigma}{(4\pi)^3 R^4} $$
其中 $\sigma$ 是雷达截面积（RCS），即地物反射能力的度量。在 SAR 图像上，$\sigma$ 主要由以下因素决定：

1.  **表面粗糙度 (Surface Roughness)**：
    *   **平滑表面**（如静止水面、平坦公路）：发生**镜面反射 (Specular Reflection)**，能量被反射到另一侧，传感器接收到的回波极少。**图像表现为黑色**。
    *   **粗糙表面**（如森林、裸土）：发生**漫反射 (Diffuse Scattering)**，部分能量沿原路返回。**图像表现为灰色/亮色**。
    *   *Rule-of-thumb*: 判断表面是“粗糙”还是“平滑”，取决于瑞利判据 (Rayleigh Criterion)，即表面起伏高度 $h$ 与波长 $\lambda$ 的关系。对于长波长雷达，砾石路面可能看起来像镜子一样光滑。

2.  **介电常数 (Dielectric Constant)**：
    *   主要反映**含水量**。水本身是强反射体（如果表面粗糙），但在自然界中，湿润的土壤通常比干燥的土壤回波更强（更亮）。
    *   *金属物体*：具有极高的介电常数，回波极强。

3.  **几何结构 (Geometry / Double Bounce)**：
    *   **角反射器 (Corner Reflector)**：当雷达波射入墙角（地面+墙面）时，会发生**二次散射 (Double Bounce)**，能量被精确地反向送回传感器。
    *   **现象**：城市区域在 SAR 图像中通常表现为极亮的“星点”群。

#### 2.2.2 波段与穿透深度
波长越长，穿透力越强。

*   **X 波段 (~3cm, e.g., TerraSAR-X)**：由于波长短，遇到树叶就会反射。用于探测**树冠表面**或精细的人造物体监测。
*   **C 波段 (~5.6cm, e.g., Sentinel-1)**：主力波段。能穿透稀疏植被，对农作物结构敏感。
*   **L 波段 (~23cm, e.g., ALOS-2)**：波长长，能穿透树冠层直达**树干**甚至地面。用于森林生物量估算、林下地形反演。

#### 2.2.3 极化 (Polarization)
雷达波是横波，具有振动方向。
*   **极化 (HH, VV)**：发射和接收方向一致。VV 对海面波浪、垂直生长的作物敏感。
*   **交叉极化 (HV, VH)**：发射和接收方向垂直。通常发生在复杂的**体积散射**中（如雷达波在树冠内部多次弹射，导致偏振方向改变）。**VH 是识别生物量（Biomass）的最佳指标。**

### 2.3 侧视几何与致命畸变

这是 SAR 最大的难点。光学相机是垂直向下看（Nadir），而 SAR 必须**侧视（Side-looking）**。因为如果垂直向下发射，雷达无法区分左右两侧对称的点（距离相同）。

**测距原理**：SAR 依靠测量脉冲往返的**时间 ($t$)** 来确定位置，即**斜距 (Slant Range)**。
$$ R_{slant} = \frac{c \cdot t}{2} $$

因为是基于“时间/距离”成像，会导致以下反直觉的几何畸变：

#### A. 透视收缩 (Foreshortening)
当雷达波照射迎雷达的斜坡时，坡底和坡顶与卫星的距离差，比它们在水平面上的距离差要小。
*   **结果**：迎坡在图像上被压缩得很窄，且非常明亮（能量堆积）。

#### B. 叠掩 (Layover) —— “头重脚轻”
这是透视收缩的极端情况。
*   **场景**：当山体非常陡峭，或者面对高层建筑时。
*   **现象**：山顶（Top）比山底（Bottom）距离卫星**更近**（因为山顶“探”出来了）。
*   **结果**：雷达先接收到山顶的回波，后接收到山底的回波。在图像上，**山顶出现在山底之前**。
*   **视觉效果**：高楼大厦看起来像是由底座向传感器方向“倒下”覆盖在地面上。

#### C. 阴影 (Shadow)
背向雷达的陡坡，如果坡度超过了雷达入射角，雷达波照射不到该区域。
*   **结果**：形成绝对的黑区（无任何信号/噪点）。这与光学阴影不同，光学阴影里通常还有散射光，而雷达阴影是真正的信号盲区。

**ASCII 图解：侧视成像与叠掩**

```text
       Satellite (Moving into page)
           *
            \      Radar Pulse
             \     (Wavefronts)
              \
               \    /| Top of Building (T)
                \  / |
                 \/  |
         Distance T < Distance B !
                  \  |
                   \ | Bottom of Building (B)
    Ground _________\|_________

    Time Axis (Image):  [Start] ---> [Top(T)] ---> [Bottom(B)] ---> [Shadow] ---> [End]
    
    Image Appearance:   The top of the building appears "earlier" (left/up) 
                        in the image than the bottom.
```

### 2.4 SAR 数据处理流水线 (GRD Processing Chain)

从数据下载到能够在 GIS 软件中与地图叠加，通常需要经过标准预处理（Pre-processing）。以 Sentinel-1 GRD 数据为例：

1.  **应用轨道文件 (Apply Orbit File)**：使用精密的卫星位置数据修正元数据，提高地理定位精度。
2.  **热噪声去除 (Thermal Noise Removal)**：去除传感器电路自身产生的背景噪声，特别是在低信号区域（如海洋）。
3.  **辐射定标 (Calibration)**：将数字量化值（DN）转换为物理量。
    *   $\beta^0$ (Beta Nought): 雷达亮度系数（与几何相关）。
    *   $\sigma^0$ (Sigma Nought): 后向散射系数（假设地面水平）。
    *   $\gamma^0$ (Gamma Nought): 进一步归一化，常用于地形复杂的森林分析。
4.  **斑点滤波 (Speckle Filtering)**：(可选) 使用 Lee 或 Frost 滤波器平滑椒盐噪声，保留边缘。
5.  **辐射地形校正 (Terrain Correction / Orthorectification)**：**最关键的一步**。
    *   利用 DEM（数字高程模型）将图像从“斜距几何”纠正为“地图几何”。
    *   修正因地形起伏导致的透视收缩和位置偏移。没有这一步，SAR 图像无法与地图对齐。
6.  **分贝化 (dB Conversion)**：
    *   公式：$dB = 10 \cdot \log_{10}(\text{Linear Intensity})$
    *   作用：将动态范围极大的线性数值（如 0.001 到 100）压缩到对数区间（如 -30 到 +20），便于人眼观察和可视化增强。

### 2.5 光谱影像进阶：超越 RGB

在回到“光学”领域，除了红绿蓝，我们需要掌握以下关键波段：

1.  **近红外 (NIR)**：植被反射极强，水体吸收极强。
    *   *应用*：水陆分割、植被健康。
2.  **红边 (Red Edge)**：位于红光（吸收）与近红外（反射）的急剧爬升区域。
    *   *应用*：对叶绿素含量极度敏感，是精准农业监测作物营养压力的核心波段。
3.  **短波红外 (SWIR)**：
    *   **对水分敏感**：土壤和植被的水分含量越高，SWIR 反射率越低。
    *   **穿透烟雾**：SWIR 波长较长，比可见光更能穿透森林火灾的烟雾，常用于火点识别和烧伤痕迹（Burn Scar）提取。

**常用进阶指数**：
*   **NDWI (归一化差异水体指数)**：$(Green - NIR) / (Green + NIR)$ —— 突出水体。
*   **NDBI (归一化差异建筑指数)**：$(SWIR - NIR) / (SWIR + NIR)$ —— 突出城市不透水面。

### 2.6 多源数据融合策略 (Fusion)

如何 SAR 与多光谱结合构建更强大的地图？

#### 场景 A：全天候洪水监测
*   **痛点**：洪灾通常伴随暴雨，光学卫星全是云。
*   **方案**：
    1.  获取灾前多光谱/SAR影像作为基准（Reference）。
    2.  获取灾中 SAR 影像。
    3.  **逻辑**：洪水淹没区由“粗糙地面”（亮）变为“平静水面”（暗）。
    4.  **阈值法**：提取 SAR 影像中 $\sigma^0 < -15dB$ (经验值) 的区域作为淹没区，叠加到地图上。

#### 场景 B：作物精细分类
*   **痛点**：有些作物颜色一样（光谱特征相似），难以区分。
*   **方案**：
    1.  **光谱特征**：提供 NDVI 时间序列（物候信息）。
    2.  **SAR 特征**：提供 VV/VH 比值。玉米和水稻在生长期的结构差异巨大（水稻早期有水，SAR 呈镜面反射；玉米早期是粗糙土壤）。
    3.  **Layer Stacking**：将 [Red, NIR, SWIR, SAR_VV, SAR_VH] 叠成一个多波段立方体，输入分类器。

---

## 3. 本章小结

*   **物理本质**：SAR 是测量微波回波特性的主动遥感，核心参数是波长、极化和入射角。
*   **几何思维**：必须建立“侧视”和“距离成像”的思维模型，理解叠掩（Layover）导致的高楼倒伏方向。
*   **数据形态**：原始数据是复数，需经过 GRD 检测、多视、地形校正（RTC）转为地图投影下的强度图。
*   **dB 的意义**：使用分贝（dB）单位可以有效拉伸暗部细节（水体）和抑制亮部溢出（城市）。
*   **融合价值**：SAR 补全了光学在云雨天气的盲区，并提供了独特的纹理与结构信息，是构建全要素全球地图不可或缺的一环。

---

## 4. 常见陷阱与错误 (Gotchas)

### 陷阱 1：升轨与降轨的几何差异 (Ascending vs. Descending)
*   **现象**：同一地点的两张 SAR 影像，一张建筑物向东倒，一张向西倒。
*   **原因**：Sentinel-1 等极轨卫星有升轨（从南向北飞，雷达向右看 -> 向东看）和降轨（从北向南飞，雷达向右看 -> 向西看）。
*   **Gotcha**：在山区制图时，升轨影像可能在山的东坡产生阴影，而降轨影像在西坡产生阴影。**融合升降轨数据**是消除地形阴影盲区的常用技巧。

### 陷阱 2：水体并不总是黑色的
*   **误区**：看到水就觉得 SAR 图像应该是黑的。
*   **例外**：
    1.  **大风大浪**：海浪使得表面粗糙，回波变强（变亮）。
    2.  **淹没植被**：如果洪水淹没了草丛或树林，雷达波会发生“水面-植被”二次散射，导致异常明亮（而不是变暗）。

### 陷阱 3：地形校正必须使用高精度 DEM
*   **错误**：使用默认的粗分辨率 DEM（如 90m SRTM）校正高分辨率 SAR（如 10m Sentinel-1）。
*   **后果**：在地形起伏区，像素纠正位置不准，导致图像出现明显的“波纹”或拉伸错误，无法与路网矢量重合。
*   **建议**：对于精密制图，尽量使用 Copernicus DEM (30m) 或更好的本地 DEM。

### 陷阱 4：统计计算时切忌直接对 dB 求平均
*   **错误**：计算时序平均值时，直接 `mean(dB_values)`。
*   **数学原理**：对数域的算术平均不等于物理量的算术平均（它等于物理量的几何平均）。
*   **正确做法**：$dB \to Linear \to Mean \to dB$。
    $$ Mean_{dB} = 10 \cdot \log_{10} \left( \frac{1}{N} \sum 10^{(dB_i/10)} \right) $$

---

**下一章预告：**
至此，我们已经掌握了二维平面的所有核心影像数据（光学与雷达）。但是，真实世界是立体的。第 9 章将利用我们在本章学到的视差原理，进一步探讨如何利用**立体像对（Stereo Pair）**和**倾斜摄影**，从二维影像中反算出三维模型（3D Mesh）和点云，让地图从平面走向立体。
